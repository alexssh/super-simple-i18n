var a="[super-simple-i18n]",i=["zero","one","two","few","many"],s=/(?<=\{{).+?(?=\}})/gi,d=/\%d|\%i|\%ld|\%s|%@/i,f=(n,e)=>{let t={str:"",key:{valid:!1,value:void 0,selected:void 0,plural:void 0,replacements:void 0},content:{valid:!1,dict:void 0,locale:void 0},fallback:e?.fallback??""};if(n)t.key.valid=!0,t.key.value=n;else return!e?.silent&&console.warn(`${a} 'key' is not defined`,{inputKey:n,options:e,t}),t.fallback;if(!e?.locale&&!e?.defaultLocale)return!e?.silent&&console.warn(`${a} 'options.locale' or 'options.defaultLocale' are not defined`,{inputKey:n,options:e,t}),t.fallback;if(e?.content)t.content=o(t,e);else return!e?.silent&&console.warn(`${a} 'options.content' is not defined`,{inputKey:n,options:e,t}),t.fallback;if(t.content.valid)if(t.key=u(t),t.key.valid)if(t.key.replacements===void 0!==t.key.replacements?.valid){if(t.key.plural!==void 0)if(e?.plural&&(typeof e?.plural=="string"||typeof e?.plural=="number")){if(t.str=p(t,e),!t.str.length)return!e?.silent&&console.warn(`${a} 'options.plural' does not exists in 'key'`,{inputKey:n,options:e,t}),t.fallback}else return!e?.silent&&console.warn(`${a} 'key' is plural, and 'options.plural' is not defined or has wrong type (must be 'string' or 'number')`,{inputKey:n,options:e,t}),t.fallback;if(t.key.plural===void 0&&(t.str=t.key.selected),t.key.replacements!==void 0)if(e?.replacements&&typeof e?.replacements=="object")t.key.replacements.type==="template"&&(t.str=k(t,e)),t.key.replacements.type==="array"&&(t.str=g(t,e));else return!e?.silent&&console.warn(`${a} 'key' has replacements, and 'options.replacements' is not defined or has wrong type (must be 'array' or 'object')`,{inputKey:n,options:e,t}),t.fallback;return t.str}else return console.warn(`${a} 'key' does not have consistent replacements, use {{name}} or - like values`,{inputKey:n,options:e,t}),t.fallback;else return console.warn(`${a} 'content' does not contain 'key'`,{inputKey:n,options:e,t}),t.fallback;else return!e?.silent&&console.warn(`${a} 'content' does not contain any object matching 'locale' or 'defaultLocale'`,{inputKey:n,options:e,t}),t.fallback},o=(n,e)=>e.content.hasOwnProperty(e.locale)?(n.content.valid=!0,n.content.dict=e.content[e.locale],n.content.locale=e.locale,n.content):(e.content.hasOwnProperty(e.defaultLocale)&&(n.content.valid=!0,n.content.dict=e.content[e.defaultLocale],n.content.locale=e.defaultLocale),n.content),u=n=>(typeof n.key.value=="string"&&(n.key.selected=n.content.dict,n.key=n.key.value.split(".").reduce((e,l)=>e.valid?e.selected.hasOwnProperty(l)?{...n.key,valid:!0,selected:e.selected[l]}:{...n.key,valid:!1,selected:e.selected}:e,n.key)),n.key.plural=y(n.key),n.key.replacements=m(n.key),n.key),y=n=>{if(typeof n.selected=="object"&&!n.selected.length)return Object.keys(n.selected).some(e=>typeof e=="string"?i.includes(e):!1)},m=n=>{if(n.plural){let e=Object.values(n.selected).map(l=>typeof l=="string"?c(l):void 0).filter(l=>l!==void 0);if(e.length)return{valid:e.every(l=>l.valid),type:e.some(l=>l.type?l.type.includes("template"):!1)&&e.some(l=>l.type?l.type.includes("array"):!1)?void 0:e.every(l=>l.type?l.type.includes("template"):!1)?"template":e.every(l=>l.type?l.type.includes("array"):!1)?"array":void 0}}if(typeof n.selected=="string")return c(n.selected)},c=n=>{let e=Boolean(n.match(s)),l=Boolean(n.match(d));return!e&&!l?void 0:{valid:e&&l?!1:e||l,type:e&&l?void 0:e?"template":l?"array":void 0}},p=(n,e)=>{let l=typeof e.plural=="string"?e.plural:new Intl.PluralRules(n.content.locale).select(e.plural);return n.key.selected.hasOwnProperty(l)?n.key.selected[l]:""},k=(n,e)=>{let l=e?.replacements;return l?n.str.match(s).reduce((r,t)=>l?.hasOwnProperty(t)?r.replace(new RegExp(`{{${t}}}`,"gi"),String(l?.[t])):r,n.str):n.str},g=(n,e)=>{let l=e?.replacements;return l?l.reduce((r,t)=>r.replace(d,String(t).trim()),n.str):n.str},R=f;export{R as t,f as translate};
